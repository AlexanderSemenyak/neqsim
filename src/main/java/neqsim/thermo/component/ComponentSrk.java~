  /*
   * System_SRK_EOS.java
   *
   * Created on 8. april 2000, 23:14
   */

package thermo.component;

import thermo.phase.*;
import thermo.mixingRule.*;
import MathLib.nonLinearSolver.*;
import thermo.component.atractiveEosTerm.*;
/**
 *
 * @author  Even Solbraa
 * @version
 */
public class ComponentSrk extends ComponentEos{
    
    /** Creates new System_SRK_EOS
     * Ev liten fil ja.
     */
    
    public ComponentSrk() {
    }
    
    public ComponentSrk(double moles) {
        numberOfMoles = moles;
    }
    
    public ComponentSrk(String component_name, double moles, double molesInPhase, int compnumber){
        super(component_name, moles, molesInPhase, compnumber);
        
        a  			= 1.0/(9.0*(Math.pow(2.0,1.0/3.0)-1.0)) * R * R * criticalTemperature * criticalTemperature / criticalPressure;
        b  			= (Math.pow(2.0,1.0/3.0)-1.0)/3.0 * R * criticalTemperature / criticalPressure;
        System.out.println("a "+a);
        delta1 = 1.0;
        delta2 = 0.0;
        // atractiveParameter = new AtractiveTermSchwartzentruber(this);
        atractiveParameter = new AtractiveTermSrk(this);
    }
    
    public ComponentSrk(int number, double TC, double PC, double M, double a, double moles) {
        super(number, TC, PC, M, a, moles);
    }
    
    public Object clone(){
        
        ComponentSrk clonedComponent = null;
        try{
            clonedComponent = (ComponentSrk) super.clone();
        }
        catch(Exception e) {
            e.printStackTrace(System.err);
        }
        
        return clonedComponent;
    }
    
    public void init(double temperature,double pressure,double totalNumberOfMoles, double beta,int type){
        super.init(temperature, pressure, totalNumberOfMoles, beta, type);
    }
    
    public double getVolumeCorrection(){
        if(this.getRacketZ()<1e-10) return 0.0;
        else return 0.40768*(0.29441-this.getRacketZ())*R*criticalTemperature/criticalPressure;
    }
    
    public double getQpure(double temperature){
        return this.getaT()/(this.getb()*R*temperature);
    }
    
    public double getdQpuredT(double temperature){
        return dqPuredT;
    }
    
    public double getdQpuredTdT(double temperature){
        return dqPuredTdT;
    }
}
