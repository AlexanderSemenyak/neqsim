/*
 * pTphaseEnvelope.java
 *
 * Created on 14. oktober 2000, 21:59
 */

package thermodynamicOperations.phaseEnvelopeOps.multicomponentEnvelopeOps;

import dataPresentation.*;
import thermo.system.*;
import thermodynamicOperations.*;
import com.jrefinery.chart.*;
import dataPresentation.visAD.visAd2D.*;
import dataPresentation.visAD.visAd3D.*;


import visad.*;
import visad.java2d.DisplayImplJ2D;
import visad.java3d.DisplayImplJ3D;
import java.rmi.RemoteException;
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;


/**
 *
 * @author  Even Solbraa
 * @version
 */
public class HPTphaseEnvelope extends Object implements OperationInterface, java.io.Serializable{
    
    double[][] points = new double[10][10];
    SystemInterface system;
    ThermodynamicOperations testOps;
    JProgressBar monitor;
    JFrame mainFrame;
    JPanel mainPanel;
    double startPressure=1, endPressure=0, startTemperature=160, endTemperature=0;
    
    /** Creates new bubblePointFlash */
    public HPTphaseEnvelope() {
    }
    
    public HPTphaseEnvelope(SystemInterface system) {
        testOps = new ThermodynamicOperations(system);
        this.system = system;
        mainFrame = new JFrame("Progress Bar");
        mainPanel = new JPanel();
        mainPanel.setSize(200,100);
        mainFrame.getContentPane().setLayout(new FlowLayout());
        mainPanel.setLayout(new FlowLayout());
        mainFrame.setSize(200,100);
        monitor = new JProgressBar(0,1000);
        monitor.setSize(200,100);
        monitor.setStringPainted(true);
        mainPanel.add(monitor);
        mainFrame.getContentPane().add(mainPanel);
        mainFrame.setVisible(true);
    }
    
    
    public void run(){
        
        int np =0;
        
        for(int i = 0;i<10;i++){
            system.setPressure(i*0.5+startPressure);
            for(int j=0;j<10;j++){
                np++;
                if(np%2==0){
                    monitor.setValue(np);
                    monitor.setString("Calculated points: " + np);
                }
                
                system.setTemperature(startTemperature+j);
                testOps.TPflash();
                system.init(3);
                points[i][j] = system.getEnthalpy();
            }
        }
    }
    
    public void displayResult(){
        try{
            mainFrame.hide();
            visAd3DPlot plot = new visAd3DPlot("pressure[bar]", "temperature[K]", "enthalpy[J/mol]");
            plot.setXYvals(150, 160, 10, 10, 20, 10);
            plot.setZvals(points);
            plot.init();
        }
        catch(Exception e){
            System.out.println("plotting failed");
        }
    }
    
    public void printToFile(String name) {
    }
    
    
    public double[][] getPoints(int i){
        return points;
    }
    
    public void createNetCdfFile(String name){
    }
}
